"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2756],{82190:function(e,t,n){var s=n(30266),r=n(809),i=n.n(r),a=n(67294),c=n(49566),l=n(32275),o=n(77084),d=n(3413),u=n(39499),m=n.n(u),x=n(88054),f=n(60035),v=n(7570),h=n(88154),p=n(12954),j=n(53367),g=n(4866),N=n(71870),_=n(31427),w=n(35277),b=n(85893);t.Z=function(e){var t=e.show,n=e.onClose,r=e.data,u=(0,a.useState)(!1),y=u[0],k=u[1],S=(0,a.useState)(!1),I=S[0],F=S[1],E=(0,a.useState)(!1),Z=E[0],A=E[1],B=(0,_.Z)(),C=B.currentUser,T=B.setTransactionRes,L=(0,j.Z)(r.metadata.creator_id),D=(0,v.Y)().localeLn;(0,a.useEffect)((function(){t&&(0,p.mq)(r.token_series_id)}),[t]);var O=function(){var e=(0,s.Z)(i().mark((function e(){var t,s,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C){e.next=3;break}return k(!0),e.abrupt("return");case 3:return A(!0),t={token_series_id:r.token_series_id,receiver_id:C},s=m().add(m().BigInt(r.price),m().BigInt(x.STORAGE_MINT_FEE)),(0,p.Ps)(r.token_series_id),e.prev=7,e.next=10,w.default.callFunction({contractId:r.contract_id,methodName:"nft_buy",args:t,gas:x.GAS_FEE,deposit:s.toString()});case 10:null!==(a=e.sent)&&void 0!==a&&a.response&&(n(),T(null===a||void 0===a?void 0:a.response)),A(!1),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(7),(0,h.p)(e.t0),A(!1);case 19:case"end":return e.stop()}}),e,null,[[7,15]])})));return function(){return e.apply(this,arguments)}}();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Z,{isShow:t,closeOnBgClick:!1,closeOnEscape:!1,close:n,children:(0,b.jsxs)("div",{className:"max-w-sm w-full p-4 bg-gray-800 m-4 md:m-auto rounded-md relative",children:[(0,b.jsx)("div",{className:"absolute right-0 top-0 pr-4 pt-4",children:(0,b.jsx)("div",{className:"cursor-pointer",onClick:n,children:(0,b.jsx)(f.kL,{})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-white tracking-tight",children:D("ConfirmBuy")}),(0,b.jsxs)("p",{className:"text-white mt-2",children:[D("AreAboutToPurchase")," ",(0,b.jsx)("b",{children:r.metadata.title})]}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)("div",{className:"mt-2 text-sm text-red-500"})}),(0,b.jsx)("div",{className:"mt-4 text-center",children:(0,b.jsxs)("div",{className:"text-white my-1",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-sm",children:D("Total")}),(0,b.jsx)("div",{className:"text",children:r.price&&"".concat((0,o.formatNearAmount)(r.price)," \u24c3")})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"text-sm",children:D("StorageFee")}),(0,b.jsxs)("div",{className:"text",children:[(0,o.formatNearAmount)(x.STORAGE_MINT_FEE)," \u24c3"]})]})]})}),(null===L||void 0===L?void 0:L.flag)&&(0,b.jsx)("div",{className:"z-20 bottom-0 flex items-center justify-center px-4 mt-4 w-full",children:(0,b.jsx)("p",{className:"text-white text-sm m-2 mt-2 p-1 font-bold w-full mx-auto px-4 text-center rounded-md ".concat(g.M[null===L||void 0===L?void 0:L.flag]),children:D(g.z[null===L||void 0===L?void 0:L.flag])})}),(0,b.jsx)("p",{className:"text-white mt-4 text-sm text-center opacity-90 px-4",children:D("RedirectedToconfirm")}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)(c.Z,{size:"md",isFullWidth:!0,onClick:function(){return null!==L&&void 0!==L&&L.flag?F(!0):O()},isDisabled:Z,isLoading:Z,children:"0"!==r.price?D("Buy"):D("GetForFree")}),(0,b.jsx)(c.Z,{variant:"ghost",size:"md",isFullWidth:!0,className:"mt-4",onClick:n,children:D("Cancel")})]})]})]})}),I&&(0,b.jsx)(N.Z,{creatorData:L,action:O,setIsShow:function(e){return F(e)},onClose:n}),(0,b.jsx)(d.Z,{onClose:function(){return k(!1)},show:y})]})}},96803:function(e,t,n){var s=n(30266),r=n(809),i=n.n(r),a=n(67294),c=n(49566),l=n(32275),o=n(77084),d=n(39499),u=n.n(d),m=n(54929),x=n(88054),f=n(60035),v=n(7570),h=n(88154),p=n(12954),j=n(42283),g=n(83019),N=n(81941),_=n(35277),w=n(31427),b=n(85893);t.Z=function(e){var t,n,r=e.show,d=e.onClose,y=e.data,k=(0,a.useState)(null),S=k[0],I=k[1],F=(0,a.useState)(y.price?(0,o.formatNearAmount)(y.price):""),E=F[0],Z=F[1],A=(0,a.useState)(!1),B=A[0],C=A[1],T=(0,a.useState)(!1),L=T[0],D=T[1],O=(0,a.useState)(""),P=O[0],R=O[1],z=(0,j.cI)(),G=z.register,M=z.handleSubmit,W=z.errors,U=(0,v.Y)().localeLn,Y=((null===S||void 0===S?void 0:S.next_fee)||0)>((null===S||void 0===S?void 0:S.current_fee)||0),q=U("DynamicTxFee",{date:(0,N.sG)(1e3*((null===S||void 0===S?void 0:S.start_time)||0)),fee:((null===S||void 0===S?void 0:S.current_fee)||0)/100}),H=(0,w.Z)(),$=H.currentUser,J=H.setTransactionRes;(0,a.useEffect)((function(){r&&function(){var e=(0,s.Z)(i().mark((function e(){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="x.paras.near"===y.contract_id?y.contract_id:"marketplace.paras.near",e.next=3,_.default.viewFunction({methodName:"get_transaction_fee",contractId:t});case 3:n=e.sent,I(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[r]),(0,a.useEffect)((function(){if(null!==y&&void 0!==y&&y.transaction_fee&&E){var e=(null===y||void 0===y?void 0:y.transaction_fee)/1e4*100;R(e.toString())}}),[r,E]);var K=function(){var e=(0,s.Z)(i().mark((function e(){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($){e.next=2;break}return e.abrupt("return");case 2:return C(!0),t={token_series_id:y.token_series_id,price:(0,o.parseNearAmount)(E)},(0,p.ry)(y.token_series_id),e.prev=5,e.next=8,_.default.callFunction({contractId:y.contract_id,methodName:"nft_set_series_price",args:t,gas:x.GAS_FEE,deposit:"1"});case 8:null!==(n=e.sent)&&void 0!==n&&n.response&&(d(),J(null===n||void 0===n?void 0:n.response)),C(!1),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),(0,h.p)(e.t0);case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=(0,s.Z)(i().mark((function e(t){var n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),$){e.next=3;break}return e.abrupt("return");case 3:return D(!0),(0,p.$W)(y.token_series_id),e.prev=5,n={token_series_id:y.token_series_id},e.next=9,_.default.callFunction({contractId:y.contract_id,methodName:"nft_set_series_price",args:n,gas:x.GAS_FEE,deposit:"1"});case 9:null!==(s=e.sent)&&void 0!==s&&s.response&&(d(),J(null===s||void 0===s?void 0:s.response)),D(!1),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),(0,h.p)(e.t0);case 17:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(t){return e.apply(this,arguments)}}(),V=function(){if(E&&u().greaterThan(u().BigInt((0,o.parseNearAmount)(E)),u().BigInt(0))){var e;e=null!==S&&void 0!==S&&S.start_time&&new Date>new Date(1e3*(null===S||void 0===S?void 0:S.start_time))?u().BigInt((null===S||void 0===S?void 0:S.next_fee)||0):u().BigInt((null===S||void 0===S?void 0:S.current_fee)||0),"comic.paras.near"===y.contract_id&&(e=u().BigInt(500));var t=Object.values(y.royalty).length>0?u().divide(u().multiply(u().BigInt((0,o.parseNearAmount)(E)),u().BigInt(Object.values(y.royalty).reduce((function(e,t){return parseInt(e)+parseInt(t)}),0))),u().BigInt(1e4)):u().BigInt(0),n=u().divide(u().multiply(u().BigInt((0,o.parseNearAmount)(E)),e),u().BigInt(1e4)),s=u().add(t,n),r=u().subtract(u().BigInt((0,o.parseNearAmount)(E)),s);return{receive:(0,o.formatNearAmount)(r.toString()),royalty:(0,o.formatNearAmount)(t.toString()),fee:(0,o.formatNearAmount)(n.toString())}}return{receive:0,royalty:0,fee:0}};return(0,b.jsx)(l.Z,{isShow:r,closeOnBgClick:!1,closeOnEscape:!1,close:d,children:(0,b.jsxs)("div",{className:"max-w-sm w-full p-4 bg-gray-800 m-auto rounded-md relative",children:[(0,b.jsx)("div",{className:"absolute right-0 top-0 pr-4 pt-4",children:(0,b.jsx)("div",{className:"cursor-pointer",onClick:d,children:(0,b.jsx)(f.kL,{})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-white tracking-tight",children:U("SeriesListing")}),(0,b.jsxs)("form",{onSubmit:M(K),children:[(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsxs)("label",{className:"block text-sm text-white mb-2",children:[U("NewPrice")," ",y.price&&"(".concat(U("CurrentPrice"),": ").concat((0,o.formatNearAmount)(y.price)," \u24c3)")]}),(0,b.jsxs)("div",{className:"flex justify-between rounded-md border-transparent w-full relative",children:[(0,b.jsx)(m.oH,{type:"number",step:"any",name:"newPrice",value:E,onChange:function(e){return Z(e.target.value)},placeholder:"Card price per pcs",className:W.newPrice&&"error",ref:G({min:0,max:999999999})}),(0,b.jsx)("div",{className:"absolute inset-y-0 right-3 flex items-center text-white",children:"\u24c3"})]}),(0,b.jsxs)("div",{className:"mt-2 text-sm text-red-500",children:["min"===(null===(t=W.newPrice)||void 0===t?void 0:t.type)&&"Minimum 0","max"===(null===(n=W.newPrice)||void 0===n?void 0:n.type)&&"Maximum 999,999,999 \u24c3"]}),(0,b.jsxs)("div",{className:"mt-2 flex items-center justify-between ".concat(Y?"text-gray-300":"text-gray-200"),children:[(0,b.jsxs)("span",{children:[U("Receive"),":"]}),(0,b.jsxs)("span",{children:[V().receive," \u24c3"]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between ".concat(Y?"text-gray-300":"text-gray-200"),children:[(0,b.jsxs)("span",{children:[U("Royalty"),":"]}),(0,b.jsxs)("span",{children:[V().royalty," \u24c3"]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between ".concat(Y?"font-bold text-white":"text-gray-200"),children:[(0,b.jsx)(g.Z,{id:"text-fee",show:Y,text:q,className:"font-normal",children:(0,b.jsxs)("span",{children:[U("Fee"),Y&&(0,b.jsx)(f.aU,{size:10,color:"#ffffff"}),":"]})}),(0,b.jsx)(g.Z,{id:"text-number",show:Y,text:q,className:"font-normal",place:"left",children:(0,b.jsxs)("span",{children:[" ",V().fee," \u24c3"]})})]}),y.transaction_fee&&S&&"".concat(null===S||void 0===S?void 0:S.current_fee)!==y.transaction_fee&&(0,b.jsx)("div",{className:"flex items-center",children:(0,b.jsx)(g.Z,{id:"locked-fee",show:!0,text:"This is the current locked transaction fee. Every update to the NFT price will also update the value according to the global transaction fee.",className:"font-normal",type:"light",children:(0,b.jsxs)("div",{className:"border-primary p-1 rounded-md border-2 text-xs mr-1 flex",children:[(0,b.jsxs)("span",{className:" text-white font-semibold",children:[U("LockedFee")," :"]}),(0,b.jsxs)("span",{className:" text-white font-semibold",children:[" ",P," %"]})]})})}),(0,b.jsx)("div",{className:"mt-2 text-sm text-red-500"})]}),(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsx)(c.Z,{type:"submit",size:"md",isFullWidth:!0,isDisabled:""===E||B,isLoading:B,children:U("UpdateListing")}),(0,b.jsx)(c.Z,{className:"mt-4",type:"submit",variant:"ghost",size:"md",isFullWidth:!0,onClick:Q,isDisabled:!y.price||L,isLoading:L,children:U("RemoveListing")})]})]})]})]})})}}}]);
//# sourceMappingURL=2756-f0e3799cd02e2e002c31.js.map